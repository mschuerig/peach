# generated: 2026-02-22
# project: peach
# project_key: NOKEY
# tracking_system: file-system
# story_location: docs/implementation-artifacts

# STATUS DEFINITIONS:
# ==================
# Epic Status:
#   - backlog: Epic not yet started
#   - in-progress: Epic actively being worked on
#   - done: All stories in epic completed
#
# Epic Status Transitions:
#   - backlog -> in-progress: Automatically when first story is created (via create-story)
#   - in-progress -> done: Manually when all stories reach 'done' status
#
# Story Status:
#   - backlog: Story only exists in epic file
#   - ready-for-dev: Story file created in stories folder
#   - in-progress: Developer actively working on implementation
#   - review: Ready for code review (via Dev's code-review workflow)
#   - done: Story completed
#
# Retrospective Status:
#   - optional: Can be completed but not required
#   - done: Retrospective has been completed
#
# WORKFLOW NOTES:
# ===============
# - Epic transitions to 'in-progress' automatically when first story is created
# - Stories can be worked in parallel if team capacity allows
# - SM typically creates next story after previous one is 'done' to incorporate learnings
# - Dev moves story to 'review', then runs code-review (fresh context, different LLM recommended)

generated: 2026-02-22
project: peach
project_key: NOKEY
tracking_system: file-system
story_location: docs/implementation-artifacts

development_status:
  # Epic 1: Remember Every Note - Data Foundation
  epic-1: done
  1-1-create-xcode-project-and-folder-structure: done
  1-2-implement-comparisonrecord-data-model-and-trainingdatastore: done
  epic-1-retrospective: optional

  # Epic 2: Hear and Compare - Core Audio Engine
  epic-2: done
  2-1-implement-noteplayer-protocol-and-sinewavenoteplayer: done
  2-2-support-configurable-note-duration-and-reference-pitch: done
  epic-2-retrospective: optional

  # Epic 3: Train Your Ear - The Comparison Loop
  epic-3: done
  3-1-start-screen-and-navigation-shell: done
  3-2-trainingsession-state-machine-and-comparison-loop: done
  3-3-training-screen-ui-with-higher-lower-buttons-and-feedback: done
  3-4-training-interruption-and-app-lifecycle-handling: done
  epic-3-retrospective: optional

  # Epic 4: Smart Training - Adaptive Algorithm
  epic-4: done
  4-1-implement-perceptualprofile: done
  4-2-implement-nextnotestrategy-protocol-and-adaptivenotestrategy: done
  4-3-integrate-adaptive-algorithm-into-trainingsession: done
  epic-4-retrospective: optional

  # Hotfixes: Algorithm Convergence & Profile Accuracy
  hotfix-tune-kazez-convergence: done
  hotfix-profile-band-segmentation: backlog # Confidence band draws across untrained gaps despite segment logic

  # Epic 5: See Your Progress - Profile & Statistics
  epic-5: done
  5-1-profile-screen-with-perceptual-profile-visualization: done
  5-2-summary-statistics-with-trend-indicator: done
  5-3-profile-preview-on-start-screen-and-navigation: done
  epic-5-retrospective: optional

  # Epic 6: Make It Yours - Settings & Configuration
  epic-6: done
  6-1-settings-screen-with-all-configuration-options: done # Include "Reset all training data" action
  6-2-apply-settings-to-training-in-real-time: done
  epic-6-retrospective: optional

  # Epic 7: Polish & Ship - Platform, Localization & Info
  epic-7: done
  7-1-english-and-german-localization: done
  7-2-accessibility-audit-and-custom-component-labels: done
  7-3-iphone-ipad-portrait-and-landscape-support: done
  7-4-info-screen: done
  7-5-app-icon-design-and-implementation: done
  epic-7-retrospective: optional

  # Sprint 2026-02-22: Bug Fixes & Algorithm Investigation
  # Work order: top to bottom
  hotfix-investigate-signed-mean: done # Investigate Signed Mean in Perceptual Profile
  fix-audio-clicks-when-navigating-away: done # Audio clicks/pops when navigating away during playback
  fix-reset-all-data-should-reset-difficulty: done # Reset All Data should also reset Kazez convergence chain
  fix-feedback-icon-flicker-on-correctness-change: done # Feedback icon briefly shows previous icon before current

  # Infrastructure: Sampled Instrument Build Support
  infra-sf2-build-download-cache: done # Download SF2 samples to cache at build time, keep out of git

  # Epic 8: Real Instruments — Sampled Sound Sources
  epic-8: done
  8-1-implement-soundfont-noteplayer: done # SoundFontNotePlayer with fixed Cello preset, RoutingNotePlayer, freq->MIDI conversion
  8-2-sf2-preset-discovery-and-instrument-selection: done # SF2 PHDR parsing, SoundFontLibrary, dynamic instrument picker in Settings
  8-3-remove-sinewavenoteplayer-and-routingnoteplayer: done # Remove SineWaveNotePlayer + RoutingNotePlayer, SoundFontNotePlayer becomes sole NotePlayer

  # Epic 9: Evidence-Based Training — Note Selection Strategy
  epic-9: done
  9-1-promote-kazeznotestrategy-to-default: done # Respect settings range, smarter cold start, swap default in PeachApp, remove NvM slider
  9-2-rethink-profile-display-and-progress-tracking: done # Adapt visualization to single-skill model

  # Epic 10: Vary Loudness Training Complication
  epic-10: done
  10-1-research-volume-control-in-avaudiounitsampler: done # Research AVAudioEngine volume control independent of MIDI velocity
  10-2-rename-amplitude-to-velocity: done # Rename amplitude→velocity, retype Double→UInt8 throughout codebase
  10-3-add-amplitude-parameter-to-noteplayer: done # Add true amplitude (volume) parameter to NotePlayer protocol
  10-4-add-vary-loudness-slider-to-settings: done # "Vary Loudness" slider in Settings with @AppStorage
  10-5-apply-loudness-variation-in-training: done # TrainingSession applies random loudness offset to note2

  # Epic 11: Clear the Decks — Prerequisite Renames
  epic-11: done
  11-1-rename-training-types-and-files-to-comparison: done # Rename ambiguous Training names to Comparison-specific names

  # Epic 12: Own Every Note — PlaybackHandle Redesign
  epic-12: done
  12-1-playbackhandle-protocol-and-noteplayer-redesign: done # PlaybackHandle protocol, NotePlayer redesign, SoundFontPlaybackHandle
  12-2-comparisonsession-playbackhandle-integration: wont-do # Superseded by 12.1 — stopAll() and convenience method cover ComparisonSession's needs

  # Epic 13: Remember Every Match — Pitch Matching Data Layer
  epic-13: done
  13-1-pitchmatchingrecord-data-model-and-trainingdatastore-extension: done

  # Epic 14: Know Both Skills — Profile Protocol Split
  epic-14: done
  14-1-extract-pitchdiscriminationprofile-protocol: done
  14-2-pitchmatchingprofile-protocol-and-matching-statistics: done

  # Epic 15: Tune Your Ear — PitchMatchingSession
  epic-15: done
  15-1-pitchmatchingsession-core-state-machine: done
  15-2-pitchmatchingsession-interruption-and-lifecycle-handling: done
  epic-15-retrospective: optional

  # Epic 16: See and Slide — Pitch Matching Screen
  epic-16: done
  16-1-vertical-pitch-slider-component: done
  16-2-pitch-matching-feedback-indicator: done
  16-3-pitch-matching-screen-assembly: done
  epic-16-retrospective: optional

  # Epic 17: Two Modes, One App — Start Screen Integration
  epic-17: done # All ACs fulfilled by story 16.3 implementation
  17-1-pitch-matching-button-and-navigation-routing: done # Implemented as part of 16-3-pitch-matching-screen-assembly

  # Epic 18: The Full Picture — Profile Screen Integration
  epic-18: done
  18-1-display-pitch-matching-statistics-on-profile-screen: done

  # Epic 19: Code Review Refactoring
  epic-19: done
  19-1-clamping-utility-and-magic-value-constants: done
  19-2-value-objects-for-domain-primitives: done
  19-3-usersettings-wrapper-for-userdefaults: done
  19-4-extract-long-methods: done
  19-5-trainingsession-protocol-and-dependency-cleanup: done
  epic-19-retrospective: done

  # Epic 20: Right Direction — Dependency Inversion Cleanup
  epic-20: done
  20-1-move-shared-domain-types-to-core: done
  20-2-move-soundsourceid-to-core: done
  20-3-move-noteduration-to-core-audio: done
  20-4-remove-cross-feature-feedback-icon-size-dependency: done
  20-5-use-protocols-in-profile-views: done
  20-6-extract-entry-environment-keys-from-core: done
  20-7-remove-uikit-from-audiosessioninterruptionmonitor: done
  20-8-resettable-protocol-for-comparisonsession: done
  20-9-move-mockhapticfeedbackmanager-to-test-target: done
  20-10-inject-trainingdatastore-into-settingsscreen: done
  20-11-update-documentation: done
  epic-20-retrospective: done

  # Bug Fix: SoundFont audio click on note stop
  fix-soundfont-click-on-note-stop: review
